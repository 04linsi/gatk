\documentclass[11pt]{article}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{fullpage}
\usepackage{tabto}
\usepackage[mathscr]{euscript}
\usepackage{graphicx}
\usepackage{color}
\usepackage{scrextend}
\usepackage[makeroom]{cancel}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{tikz}
\usetikzlibrary{arrows}

\definecolor{Purple}{rgb}{.9,0,.9}
\newcommand{\solution}[1]{\textcolor{Purple}{\\Solution: #1}}  %Solution
\newcommand{\C}[1]{\ensuremath{\mathord{\rm #1}}}
\newcommand{\pair}[1]{\ensuremath{\mathopen{\langle}#1\mathclose{\rangle}}}
\newcommand{\lng}[1]{\ensuremath{\mathopen{|}#1\mathclose{|}}}
\newcommand{\card}[1]{\ensuremath{\mathopen{|\!|}#1\mathclose{|\!|}}}
\newcommand{\manyone}{\ensuremath{\leq_m^p}}
\newcommand{\pmli}{\ensuremath{\leq_{m,\mathord{\rm li}}^p}}
\newcommand{\ponem}{\ensuremath{\mathrel{\leq_m^{p/1}}}}
\newcommand{\ponett}{\ensuremath{\mathrel{\leq_{1-\mathord{\rm tt}}^{p/1}}}}
\newcommand{\ptt}{\ensuremath{\mathrel{\leq_{\mathord{\rm tt}}^p}}}
\newcommand{\pktt}{\ensuremath{\mathrel{\leq_{k-\mathord{\rm tt}}^p}}}
\newcommand{\pttk}[1]{\ensuremath{\mathrel}{\leq_{#1-\mathord{\rm
        tt}}^p}}
\newcommand{\pmhat}{\ensuremath{\mathrel{\leq_{\hat{m}}^p}}}
\newcommand{\pmhatli}{\ensuremath{\mathrel{\leq_{\hat{m}\mathord{\rm
          ,l.i.}}^p}}}
\newcommand{\pmhathonest}{\ensuremath{\mathrel{\leq_{\hat{m},\mathord{\rm honest}}^p}}}
\newcommand{\PNP}{\C{P}^{\C{NP}}}
\newcommand{\pT}{\ensuremath{\mathrel{\leq_T^p}}}
\newenvironment{proof}{\vspace*{1em}\noindent{\bf Proof.}}{\hfill$\Box$}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}

\newcommand{\qed}{\nobreak \ifvmode \relax \else
      \ifdim\lastskip<1.5em \hskip-\lastskip
      \hskip1.5em plus0em minus0.5em \fi \nobreak
      \vrule height0.75em width0.5em depth0.25em\fi}

\setlength{\parindent}{0cm} 
\newcommand{\newpar}{\vspace{2mm}}




\begin{document}
\pagenumbering{gobble}

\section{Proposed New Strand Artifact Filter}

\bigbreak \noindent
The job of the strand artifact filter model is twofold. One, the model must detect that the strand composition is different between the ref and alt reads. If it is then, two, the model should check that the alt reads are heavily biased towards one read direction over the other. If both conditions are met, the variant is suspect and should be filtered. Fisher's Exact Test addresses the first criterion well but not the second. 

\bigbreak \noindent
The new model consists of a simple binomial likelihood with the beta prior. Let $\mathrm{ref}^+$, $\mathrm{ref}^-$ denote the number of forward and reverse ref reads, respectively, and define ${\rm alt^+}$ and ${\rm alt}^-$ analogously. The model stipulates that $\mathrm{alt}^+ \sim {\rm Binomial}(n_{\rm alt}, p)$ for some $p \sim {\rm Beta}(p|\alpha, \beta)$ and ${\rm n_{\rm alt}} = {\rm alt^+} + {\rm alt}^-$. Note that this is equivalent to $\mathrm{alt}^+ \sim {\rm BetaBinomial}(n_{\rm alt}, \alpha, \beta)$

\bigbreak \noindent
Given that the variant is real (i.e. the null model),  we use the strand composition of ref reads as pseudocounts for the beta prior; that is, $\alpha = {\rm ref^+}$ and $\beta = {\rm ref}^-$. 

\bigbreak \noindent
Under the artifact model, we set the hyperparameters according to our prior belief. I think that if we see only 1 forward strand out of 10 alt reads, that sites is suspect. So we set $\alpha = 1$ and $\beta = 9$.

\bigbreak \noindent
Finally, we take the likelihood ratio for each strand 

\begin{align*}
L^+ = \frac{P({\rm alt^+ | {\rm Artifact}})}{P({\rm alt^+ | {\rm Real Variant}})} \\
L^- = \frac{P({\rm alt^- | {\rm Artifact}})}{P({\rm alt^+ | {\rm Real Variant}})}
\end{align*}

and filter if either exceeds a threshold.





% \bigbreak \noindent





\end{document}
